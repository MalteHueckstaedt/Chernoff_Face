knitr::opts_chunk$set(echo = TRUE)
# Lade Datensatz
library(readxl)
df <- read_excel("Fine_Artfacts_Kunsthochschulen.xlsx")
View(df)
head(df)
head(df[,14])
head(df[,14:36])
knitr::opts_chunk$set(echo = TRUE)
# Lade Datensatz
library(readxl)
df <- read_excel("Fine_Artfacts_Kunsthochschulen.xlsx")
head(df[,14:36])
#Setzt NA auf "" und füge Spalten zusammen
library(tidyverse)
df <- df %>% replace(., is.na(.), "") %>% unite("Rank_Natio", c(14:36))
# Entferne Unterstrich, die durch die unite_Funktion verusacht wurden.
df$Rank_Natio <- str_replace_all(df$Rank_Natio, "(_+)", "") #verwandele "_" (oder mehr) in ""
#ersetze leere String-Zellen durch NA Data-Frame-weit
df <- mutate_all(df, funs(na_if(.,"")))
#colnames(df)
df$Rank_Global <- as.numeric(df$Rank_Global)
df$Rank_Natio <- as.numeric(df$Rank_Natio)
df$Kunsthochschule <- as.factor(df$Kunsthochschule)
# Erzeuge aggregierte Variablen auf KH-Ebene
# Ranking Durchschnittwerte pro Kunsthochschule
df <- df %>% group_by(Kunsthochschule) %>% mutate(Mean_Nat_Rank= mean(Rank_Natio,na.rm = T)) %>% mutate(Mean_Global_Rank = mean(Rank_Global, na.rm = T)) %>%
summarize(Sum_Nat = round(mean(Mean_Nat_Rank),2), Sum_Glob = round(mean(Mean_Global_Rank),2))
#Anzahl Professoren pro Kunsthochschule
df <- df %>% group_by(Kunsthochschule) %>% summarise (n_Profs = n())
# Anzahl geschlecht pro Kunsthochschule
df <- df %>% group_by(Kunsthochschule) %>%
summarise(n_Frau = sum(Gender == "F"), n_Mann = sum(Gender == "M"))
knitr::opts_chunk$set(echo = TRUE)
# Lade Datensatz
library(readxl)
df <- read_excel("Fine_Artfacts_Kunsthochschulen.xlsx")
head(df[,14:36])
#Setzt NA auf "" und füge Spalten zusammen
library(tidyverse)
df <- df %>% replace(., is.na(.), "") %>% unite("Rank_Natio", c(14:36))
# Entferne Unterstrich, die durch die unite_Funktion verusacht wurden.
df$Rank_Natio <- str_replace_all(df$Rank_Natio, "(_+)", "") #verwandele "_" (oder mehr) in ""
#ersetze leere String-Zellen durch NA Data-Frame-weit
df <- mutate_all(df, funs(na_if(.,"")))
#colnames(df)
df$Rank_Global <- as.numeric(df$Rank_Global)
df$Rank_Natio <- as.numeric(df$Rank_Natio)
df$Kunsthochschule <- as.factor(df$Kunsthochschule)
df <- df %>% group_by(Kunsthochschule) %>% mutate(Mean_Nat_Rank= mean(Rank_Natio,na.rm = T)) %>% mutate(Mean_Global_Rank = mean(Rank_Global, na.rm = T)) %>%
summarize(Sum_Nat = round(mean(Mean_Nat_Rank),2), Sum_Glob = round(mean(Mean_Global_Rank),2))  %>%  select(everything())
knitr::opts_chunk$set(echo = TRUE)
# Lade Datensatz
library(readxl)
df <- read_excel("Fine_Artfacts_Kunsthochschulen.xlsx")
head(df[,14:36])
#Setzt NA auf "" und füge Spalten zusammen
library(tidyverse)
df <- df %>% replace(., is.na(.), "") %>% unite("Rank_Natio", c(14:36))
# Entferne Unterstrich, die durch die unite_Funktion verusacht wurden.
df$Rank_Natio <- str_replace_all(df$Rank_Natio, "(_+)", "") #verwandele "_" (oder mehr) in ""
#ersetze leere String-Zellen durch NA Data-Frame-weit
df <- mutate_all(df, funs(na_if(.,"")))
#colnames(df)
df$Rank_Global <- as.numeric(df$Rank_Global)
df$Rank_Natio <- as.numeric(df$Rank_Natio)
df$Kunsthochschule <- as.factor(df$Kunsthochschule)
# Ranking Durchschnittwerte pro Kunsthochschule
df2 <- df %>% select(everything()) %>%
group_by(Kunsthochschule) %>%
mutate(Mean_Nat_Rank= mean(Rank_Natio,na.rm = T)) %>%
mutate(Mean_Global_Rank = mean(Rank_Global, na.rm = T)) %>%
summarize(Sum_Nat = round(mean(Mean_Nat_Rank),2), Sum_Glob =
round(mean(Mean_Global_Rank),2))
#Anzahl Professoren pro Kunsthochschule
df3 <- df2 %>% group_by(Kunsthochschule) %>% summarise (n_Profs = n())
#Anzahl Professoren pro Kunsthochschule
df3 <- df2 %>% select(everything()) %>% group_by(Kunsthochschule) %>% summarise (n_Profs = n())
knitr::opts_chunk$set(echo = TRUE)
# Lade Datensatz
library(readxl)
df <- read_excel("Fine_Artfacts_Kunsthochschulen.xlsx")
head(df[,14:36])
#Setzt NA auf "" und füge Spalten zusammen
library(tidyverse)
df <- df %>% replace(., is.na(.), "") %>% unite("Rank_Natio", c(14:36))
# Entferne Unterstrich, die durch die unite_Funktion verusacht wurden.
df$Rank_Natio <- str_replace_all(df$Rank_Natio, "(_+)", "") #verwandele "_" (oder mehr) in ""
#ersetze leere String-Zellen durch NA Data-Frame-weit
df <- mutate_all(df, funs(na_if(.,"")))
#colnames(df)
df$Rank_Global <- as.numeric(df$Rank_Global)
df$Rank_Natio <- as.numeric(df$Rank_Natio)
df$Kunsthochschule <- as.factor(df$Kunsthochschule)
# Erzeuge aggregierte Variablen auf KH-Ebene
# Ranking Durchschnittwerte pro Kunsthochschule
df <- df %>% group_by(Kunsthochschule) %>% mutate(Mean_Nat_Rank= mean(Rank_Natio,na.rm = T)) %>% mutate(Mean_Global_Rank = mean(Rank_Global, na.rm = T)) %>%
summarize(Sum_Nat = round(mean(Mean_Nat_Rank),2), Sum_Glob = round(mean(Mean_Global_Rank),2))
#Anzahl Professoren pro Kunsthochschule
df <- df %>% group_by(Kunsthochschule) %>% summarise (n_Profs = n())
# Anzahl geschlecht pro Kunsthochschule
df <- df %>% group_by(Kunsthochschule) %>%
summarise(n_Frau = sum(Gender == "F"), n_Mann = sum(Gender == "M"))
knitr::opts_chunk$set(echo = TRUE)
# Lade Datensatz
library(readxl)
df <- read_excel("Fine_Artfacts_Kunsthochschulen.xlsx")
head(df[,14:36])
#Setzt NA auf "" und füge Spalten zusammen
library(tidyverse)
df <- df %>% replace(., is.na(.), "") %>% unite("Rank_Natio", c(14:36))
# Entferne Unterstrich, die durch die unite_Funktion verusacht wurden.
df$Rank_Natio <- str_replace_all(df$Rank_Natio, "(_+)", "") #verwandele "_" (oder mehr) in ""
#ersetze leere String-Zellen durch NA Data-Frame-weit
df <- mutate_all(df, funs(na_if(.,"")))
#colnames(df)
df$Rank_Global <- as.numeric(df$Rank_Global)
df$Rank_Natio <- as.numeric(df$Rank_Natio)
df$Kunsthochschule <- as.factor(df$Kunsthochschule)
# Erzeuge aggregierte Variablen auf KH-Ebene
# Ranking Durchschnittwerte pro Kunsthochschule
Rank <- df %>% group_by(Kunsthochschule) %>% mutate(Mean_Nat_Rank= mean(Rank_Natio,na.rm = T)) %>% mutate(Mean_Global_Rank = mean(Rank_Global, na.rm = T)) %>%
summarize(Sum_Nat = round(mean(Mean_Nat_Rank),2), Sum_Glob = round(mean(Mean_Global_Rank),2))
#Anzahl Professoren pro Kunsthochschule
Profs <- df %>% group_by(Kunsthochschule) %>% summarise (n_Profs = n())
# Anzahl geschlecht pro Kunsthochschule
Gender <- df %>% group_by(Kunsthochschule) %>%
summarise(n_Frau = sum(Gender == "F"), n_Mann = sum(Gender == "M"))
# Mean_Alter pro Kunsthochschule
df$Alter <- as.numeric(df$Alter)
df$Alter <- 2019-df$Alter
Alter <- df %>% group_by(Kunsthochschule) %>% mutate(Mean_Alter= mean(Alter,na.rm = T))  %>%
summarize(Mean_Alter_Sum = round(mean(Mean_Alter),2))
df1 <- merge(Rank,Profs, by="Kunsthochschule")
df2 <- merge(df1,Gender, by="Kunsthochschule")
df3 <- merge(df2,Alter, by="Kunsthochschule")
ArtFac <- df3
rm(list=setdiff(ls(), c("ArtFac", "df")))
# colnames(ArtFac)
# filtere NA-Zeile raus
ArtFac <- ArtFac %>%  filter(!is.na(Sum_Nat))
#invertiere Ranking Skalen für Faces-Darstellung: Je niedriger, desto besser und vice versa.
# Dieses lässt den Graphen intuitiver lesen
# Columns in Rownames
ArtFac <- ArtFac %>% remove_rownames %>% column_to_rownames(var="Kunsthochschule")
rownames(ArtFac)
# ändere Namen der KHs um Faces Plot Übersichtlicher zu gestallten
rownames(ArtFac)[1]<-"AdBK M"
rownames(ArtFac)[2]<-"BU WE"
rownames(ArtFac)[3]<-"KH HAL"
rownames(ArtFac)[4]<-"HBK BS"
rownames(ArtFac)[5]<-"HfBK DD"
rownames(ArtFac)[6]<-"HfBK HH"
rownames(ArtFac)[7]<-"HFK HB"
rownames(ArtFac)[8]<-"HdBK SB"
rownames(ArtFac)[9]<-"HfG OF"
rownames(ArtFac)[10]<-"KA D"
rownames(ArtFac)[11]<-"KA MS"
rownames(ArtFac)[12]<-"KHB B"
rownames(ArtFac)[13]<-"KfM K"
rownames(ArtFac)[14]<-"KH KS"
rownames(ArtFac)[15]<-"KH KI"
rownames(ArtFac)[16]<-"KH L"
rownames(ArtFac)[17]<-"KH MZ"
rownames(ArtFac)[18]<-"KH N"
rownames(ArtFac)[19]<-"AdK KA"
rownames(ArtFac)[20]<-"AdK S"
rownames(ArtFac)[21]<-"HfBK FaM"
rownames(ArtFac)[22]<-"UdK Berlin"
library(aplpack)
faces(ArtFac[1:22,],face.type=1)
library(stringr)
colnames(df)
df$KH_Name_Short <- df$Kunsthochschule
table(df$KH_Name_Short)
class(df$KH_Name_Short)
#df$KH_Name_Short <- as.character(df$KH_Name_Short)
df$KH_Name_Short <- df$KH_Name_Short %>%
str_replace("Akademie der Bildenden Künste München","AdBK M") %>%
str_replace("Bauhaus-Universität Weimar","BU WE") %>%
str_replace("Burg Giebichenstein Kunsthochschule Halle","KH HAL") %>%
str_replace("HBK Braunschweig","HBK BS") %>%
str_replace("HfBK Dresden","HfBK DD") %>%
str_replace("HfbK Hamburg","HfBK HH") %>%
str_replace("HFK Bremen","HFK HB") %>%
str_replace("Hochschule der Bildenden Künste Saar", "HdBK SB") %>%
str_replace("Hochschule für Gestaltung Offenbach", "HfG OF") %>%
str_replace("Kunstakademie Düsseldorf","KA D") %>%
str_replace("Kunstakademie Münster","KA MS") %>%
str_replace("Kunsthochschule Berlin Weißensee","KHB B") %>%
str_replace("Kunsthochschule für Medien Köln","KfM K") %>%
str_replace("Kunsthochschule Kassel","KH KS") %>%
str_replace("Kunsthochschule Kiel","KH KI") %>%
str_replace(" \\(.*\\)", "")  %>% # einzelnd Klammern entfernen, sonst funktioniert str_replace bei  HfBK FaM nicht
str_replace("Kunsthochschule Leipzig","KH L") %>%
str_replace("Kunsthochschule Mainz","KH MZ") %>%
str_replace("Kunsthochschule Nürnberg","KH N") %>%
str_replace("Staatliche Akademie der Bildenden Künste Karlsruhe","AdK KA") %>%
str_replace("Staatliche Akademie der Bildenden Künste Stuttgart","AdK S") %>%
str_replace("Staatliche Hochschule für Bildende Künste Frankfurt am Main","HfBK FaM") %>%
str_replace("UdK Berlin","UdK B")
#Gender dichothomisieren:
df$Gender <- df$Gender %>%
str_replace("M, F","F")
df_gg <- df %>% select(Gender,KH_Name_Short,Rank_Global,Rank_Natio) %>% na.omit()
# Plot mit facet_wrap, also pro HS eine Plottafel (etwas unübersichtlich!)
# ggplot(df_gg, aes(x=factor(Gender), y=Rank_Global, fill=factor(Gender)) ) +
#   #geom_point(size=2, alpha=.6,aes(colour=factor(Gender)))+
#   geom_jitter(size=2, alpha=.6,aes(colour=factor(Gender))) +
#   geom_boxplot(alpha = 0.5, show.legend = FALSE) +
#   facet_wrap(.~ KH_Name_Short)
#Rank Global über Khs und Geschlecht
ggplot(df_gg, aes(x=factor(KH_Name_Short), y=Rank_Global, fill=factor(Gender)) ) +
#geom_point(size=2, alpha=.6,aes(colour=factor(Gender)))+
geom_jitter(size=2, alpha=.6,aes(colour=factor(Gender))) +
geom_boxplot(alpha = 0.5, show.legend = FALSE)+
theme(axis.text.x = element_text(angle=45, hjust=1))
#Rank National über Khs und Geschlecht
ggplot(df_gg, aes(x=factor(KH_Name_Short), y=Rank_Natio, fill=factor(Gender)) ) +
#geom_point(size=2, alpha=.6,aes(colour=factor(Gender)))+
geom_jitter(size=2, alpha=.6,aes(colour=factor(Gender))) +
geom_boxplot(alpha = 0.5, show.legend = FALSE)+
theme(axis.text.x = element_text(angle=45, hjust=1))
knitr::opts_chunk$set(echo = TRUE)
# Lade Datensatz
library(readxl)
df <- read_excel("Fine_Artfacts_Kunsthochschulen.xlsx")
head(df[,14:36])
#Setzt NA auf "" und füge Spalten zusammen
library(tidyverse)
df <- df %>% replace(., is.na(.), "") %>% unite("Rank_Natio", c(14:36))
# Entferne Unterstrich, die durch die unite_Funktion verusacht wurden.
df$Rank_Natio <- str_replace_all(df$Rank_Natio, "(_+)", "") #verwandele "_" (oder mehr) in ""
#ersetze leere String-Zellen durch NA Data-Frame-weit
df <- mutate_all(df, funs(na_if(.,"")))
#colnames(df)
df$Rank_Global <- as.numeric(df$Rank_Global)
df$Rank_Natio <- as.numeric(df$Rank_Natio)
df$Kunsthochschule <- as.factor(df$Kunsthochschule)
Rank <- df %>% group_by(Kunsthochschule) %>% mutate(Mean_Nat_Rank= mean(Rank_Natio,na.rm = T)) %>% mutate(Mean_Global_Rank = mean(Rank_Global, na.rm = T)) %>%
summarize(Sum_Nat = round(mean(Mean_Nat_Rank),2), Sum_Glob = round(mean(Mean_Global_Rank),2))
#Anzahl Professoren pro Kunsthochschule
Profs <- df %>% group_by(Kunsthochschule) %>% summarise (n_Profs = n())
# Anzahl geschlecht pro Kunsthochschule
Gender <- df %>% group_by(Kunsthochschule) %>%
summarise(n_Frau = sum(Gender == "F"), n_Mann = sum(Gender == "M"))
# Mean_Alter pro Kunsthochschule
df$Alter <- as.numeric(df$Alter)
df$Alter <- 2019-df$Alter
Alter <- df %>% group_by(Kunsthochschule) %>% mutate(Mean_Alter= mean(Alter,na.rm = T))  %>%
summarize(Mean_Alter_Sum = round(mean(Mean_Alter),2))
# Datenzusammenführung:
df1 <- merge(Rank,Profs, by="Kunsthochschule")
df2 <- merge(df1,Gender, by="Kunsthochschule")
df3 <- merge(df2,Alter, by="Kunsthochschule")
ArtFac <- df3
rm(list=setdiff(ls(), c("ArtFac", "df")))
knitr::opts_chunk$set(echo = TRUE)
# Lade Datensatz
library(readxl)
df <- read_excel("Fine_Artfacts_Kunsthochschulen.xlsx")
head(df[,14:36])
#Setzt NA auf "" und füge Spalten zusammen
library(tidyverse)
df <- df %>% replace(., is.na(.), "") %>% unite("Rank_Natio", c(14:36))
# Entferne Unterstrich, die durch die unite_Funktion verusacht wurden.
df$Rank_Natio <- str_replace_all(df$Rank_Natio, "(_+)", "") #verwandele "_" (oder mehr) in ""
#ersetze leere String-Zellen durch NA Data-Frame-weit
df <- mutate_all(df, funs(na_if(.,"")))
#colnames(df)
df$Rank_Global <- as.numeric(df$Rank_Global)
df$Rank_Natio <- as.numeric(df$Rank_Natio)
df$Kunsthochschule <- as.factor(df$Kunsthochschule)
# Erzeuge aggregierte Variablen auf KH-Ebene
# Ranking Durchschnittwerte pro Kunsthochschule
Rank <- df %>% group_by(Kunsthochschule) %>% mutate(Mean_Nat_Rank= mean(Rank_Natio,na.rm = T)) %>% mutate(Mean_Global_Rank = mean(Rank_Global, na.rm = T)) %>%
summarize(Sum_Nat = round(mean(Mean_Nat_Rank),2), Sum_Glob = round(mean(Mean_Global_Rank),2))
#Anzahl Professoren pro Kunsthochschule
Profs <- df %>% group_by(Kunsthochschule) %>% summarise (n_Profs = n())
# Anzahl geschlecht pro Kunsthochschule
Gender <- df %>% group_by(Kunsthochschule) %>%
summarise(n_Frau = sum(Gender == "F"), n_Mann = sum(Gender == "M"))
# Mean_Alter pro Kunsthochschule
df$Alter <- as.numeric(df$Alter)
df$Alter <- 2019-df$Alter
Alter <- df %>% group_by(Kunsthochschule) %>% mutate(Mean_Alter= mean(Alter,na.rm = T))  %>%
summarize(Mean_Alter_Sum = round(mean(Mean_Alter),2))
# Datenzusammenführung:
df1 <- merge(Rank,Profs, by="Kunsthochschule")
df2 <- merge(df1,Gender, by="Kunsthochschule")
ArtFac <- merge(df2,Alter, by="Kunsthochschule")
# entferne alle Dataframes außer ArtFac + df
rm(list=setdiff(ls(), c("ArtFac", "df")))
# colnames(ArtFac)
# filtere NA-Zeile raus
ArtFac <- ArtFac %>%  filter(!is.na(Sum_Nat))
#rownames(ArtFac)
# ändere Namen der KHs um Faces Plot Übersichtlicher zu gestallten
rownames(ArtFac)[1]<-"AdBK M"
rownames(ArtFac)[2]<-"BU WE"
rownames(ArtFac)[3]<-"KH HAL"
rownames(ArtFac)[4]<-"HBK BS"
rownames(ArtFac)[5]<-"HfBK DD"
rownames(ArtFac)[6]<-"HfBK HH"
rownames(ArtFac)[7]<-"HFK HB"
rownames(ArtFac)[8]<-"HdBK SB"
rownames(ArtFac)[9]<-"HfG OF"
rownames(ArtFac)[10]<-"KA D"
rownames(ArtFac)[11]<-"KA MS"
rownames(ArtFac)[12]<-"KHB B"
rownames(ArtFac)[13]<-"KfM K"
rownames(ArtFac)[14]<-"KH KS"
rownames(ArtFac)[15]<-"KH KI"
rownames(ArtFac)[16]<-"KH L"
rownames(ArtFac)[17]<-"KH MZ"
rownames(ArtFac)[18]<-"KH N"
rownames(ArtFac)[19]<-"AdK KA"
rownames(ArtFac)[20]<-"AdK S"
rownames(ArtFac)[21]<-"HfBK FaM"
rownames(ArtFac)[22]<-"UdK Berlin"
library(aplpack)
faces(ArtFac[1:22,],face.type=1)
View(df)
View(ArtFac)
# colnames(ArtFac)
# filtere NA-Zeile raus
ArtFac <- ArtFac %>%  filter(!is.na(Sum_Nat))
# Columns in Rownames
ArtFac <- ArtFac %>% remove_rownames %>% column_to_rownames(var="Kunsthochschule")
#rownames(ArtFac)
# ändere Namen der KHs um Faces Plot Übersichtlicher zu gestallten
rownames(ArtFac)[1]<-"AdBK M"
rownames(ArtFac)[2]<-"BU WE"
rownames(ArtFac)[3]<-"KH HAL"
rownames(ArtFac)[4]<-"HBK BS"
rownames(ArtFac)[5]<-"HfBK DD"
rownames(ArtFac)[6]<-"HfBK HH"
rownames(ArtFac)[7]<-"HFK HB"
rownames(ArtFac)[8]<-"HdBK SB"
rownames(ArtFac)[9]<-"HfG OF"
rownames(ArtFac)[10]<-"KA D"
rownames(ArtFac)[11]<-"KA MS"
rownames(ArtFac)[12]<-"KHB B"
rownames(ArtFac)[13]<-"KfM K"
rownames(ArtFac)[14]<-"KH KS"
rownames(ArtFac)[15]<-"KH KI"
rownames(ArtFac)[16]<-"KH L"
rownames(ArtFac)[17]<-"KH MZ"
rownames(ArtFac)[18]<-"KH N"
rownames(ArtFac)[19]<-"AdK KA"
rownames(ArtFac)[20]<-"AdK S"
rownames(ArtFac)[21]<-"HfBK FaM"
rownames(ArtFac)[22]<-"UdK Berlin"
View(ArtFac)
library(aplpack)
faces(ArtFac[1:22,],face.type=1)
library(aplpack)
faces(ArtFac[1:22,],face.type=2)
?ArtFac
?faces
faces(ArtFac[1:22,],face.type=0)
faces(ArtFac[1:22,],face.type=1)
faces(ArtFac[1:22,],face.type=0)
faces(ArtFac[1:22,],face.type=1)
